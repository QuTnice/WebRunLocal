## WebRunLocal
### 1. 程序说明
WebRunLocal旨在实现网页(Web Page)和本地程序(Local App)间的动态调用，通过该软件，可以实现在网页中使用JavaScript调用本地电脑硬件、本地电脑系统API以及第三方程序集(一般指DLL、EXE)。

在网页中调用本地程序集，一般使用的方法是将DLL或EXE封装为OCX控件的方式，但是此种方式经常会因为第三方程序集的问题而导致浏览器崩溃或长时间无响应，而且随着Chrome和FireFox逐渐放弃插件技术，高版本的Chrome和FireFox已经不能再通过OCX控件的方式进行第三方程序集的调用。

WebRunLocal采用的方法是在本地电脑安装一个Windows Service服务，网页调用第三方程序集时，采用http方式请求该服务，服务收到请求后调用本地程序集获取结果，然后将结果返回。在网页和本地程序集中增加了一个中间层，降低耦合度，增强了程序的可拓展性。

### 2. 兼容性说明
系统兼容性：1、全面兼容Windows XP以上微软桌面操作系统；2、.net framework 4.0以上运行环境。
浏览器兼容性：全版本浏览器，支持http协议即可使用。

### 3. 程序优点
1. 低耦合，http请求方式可以设置异步同步请求方式以及超时时间，不会因为本地程序集的原因导致浏览器长时间无响应或崩溃。
2. 强兼容可拓展，WebRunLocal程序在调用本地程序集时，采用动态编译技术，不需要每次都封装插件，程序集即拿即用。
3. 解决了大多数高版本浏览器不再支持插件的问题。

### 4. 使用场景举例
1. 操作电脑硬件，例如打印机，传真机等电脑硬件设备。
2. 调用本地电脑系统API，例如kernel32.dll、wtsapi32.dll等系统自带的程序集。
3. 调用第三方厂商提供的DLL或EXE，便于集成到系统中。

### 5. 项目起源
项目起初要解决的是网页频繁调用DLL导致浏览器崩溃问题，由于对接的第三方厂商很多，发现的问题也比较多，大致原因如下：
* 第三方厂商提供的DLL长时间无响应或响应时间过长，导致浏览器处于卡死无响应状态，用户便认为是系统卡死。
* 第三方厂商提供的DLL内存处理有问题，频繁的调用会崩溃进而导致浏览器崩溃。
* 封装的OCX控件存在内存问题，频繁的调用内存溢出导致浏览器崩溃。

前两点问题是我们解决不了的，为了不让第三方程序的问题影响到软件的正常使用，那么就需要一个解决方案来降低浏览器和第三方程序集之间的耦合度。

启发于：[https://github.com/wangzuohuai/WebRunLocal](https://github.com/wangzuohuai/WebRunLocal)